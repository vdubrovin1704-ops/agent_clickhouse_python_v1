# üì¶ –ò—Ç–æ–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ó–∞–ø—É—Å–∫ API –Ω–∞ server.asktab.ru

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

–î–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∞—à–µ–≥–æ ClickHouse Analysis Agent API –Ω–∞ –¥–æ–º–µ–Ω–µ `server.asktab.ru` –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

### 1. üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[DEPLOYMENT.md](DEPLOYMENT.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- **[QUICKSTART_DEPLOYMENT.md](QUICKSTART_DEPLOYMENT.md)** - –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (5 –º–∏–Ω—É—Ç)

### 2. üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- **[static/index.html](static/index.html)** - –ì–æ—Ç–æ–≤—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API
  - –ö—Ä–∞—Å–∏–≤—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç —Å –∞–≥–µ–Ω—Ç–æ–º
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
  - –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
  - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ API

### 3. ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **[agent-api.service](agent-api.service)** - Systemd —Å–ª—É–∂–±–∞ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ API
- **[nginx.conf](nginx.conf)** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- **[.env.example](.env.example)** - –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 4. üöÄ API —Å–µ—Ä–≤–µ—Ä (—É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª)

- **[api_server.py](api_server.py)** - FastAPI —Å–µ—Ä–≤–µ—Ä —Å endpoints:
  - `GET /` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
  - `GET /health` - Health check
  - `GET /api/info` - –î–µ—Ç–∞–ª–∏ API
  - `POST /api/analyze` - –û—Å–Ω–æ–≤–Ω–æ–π endpoint –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
  - `GET /api/chat-stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å (–ø–æ—à–∞–≥–æ–≤–æ)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (5 –º–∏–Ω—É—Ç)

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ **[QUICKSTART_DEPLOYMENT.md](QUICKSTART_DEPLOYMENT.md)**

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–¥—Ä–æ–±–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ **[DEPLOYMENT.md](DEPLOYMENT.md)**

---

## üìù –ö—Ä–∞—Ç–∫–∏–π –ø–ª–∞–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```
1. SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É Beget
   ‚Üì
2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
   ‚Üì
3. –ó–∞–ø—É—Å–∫ setup.sh –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   ‚Üì
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞ —Å API –∫–ª—é—á–∞–º–∏
   ‚Üì
5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ClickHouse –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   ‚Üì
6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é test_agent.py
   ‚Üì
7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd —Å–ª—É–∂–±—ã –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
   ‚Üì
8. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è
   ‚Üì
9. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL —Å Let's Encrypt
   ‚Üì
10. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä –∏ curl
```

---

## üåê –ß—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### API Endpoints

```bash
# Health check
GET https://server.asktab.ru/health

# API –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
GET https://server.asktab.ru/api/info

# –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
POST https://server.asktab.ru/api/analyze
Content-Type: application/json
{
  "query": "–ü–æ–∫–∞–∂–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö",
  "session_id": "optional-session-id"
}
```

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://server.asktab.ru
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é:
- –û—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ –∞–≥–µ–Ω—Ç–∞
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ API

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ClickHouse

### –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

–ü—Ä–æ—Å—Ç–æ —É–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ `.env`:
```bash
CLICKHOUSE_HOST=your-cluster.mdb.yandexcloud.net
CLICKHOUSE_PORT=8443
CLICKHOUSE_USER=admin
CLICKHOUSE_PASSWORD=your-password
CLICKHOUSE_DATABASE=analytics
```

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é:

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ [DEPLOYMENT.md](DEPLOYMENT.md), —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ClickHouse".

–í–∞—Ä–∏–∞–Ω—Ç—ã:
1. **–Ø–Ω–¥–µ–∫—Å Cloud** - —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π ClickHouse –∫–ª–∞—Å—Ç–µ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
2. **–õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞** - –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ
3. **–î—Ä—É–≥–æ–π —Ö–æ—Å—Ç–∏–Ω–≥** - –ª—é–±–æ–π ClickHouse —Å–µ—Ä–≤–µ—Ä

---

## üîÑ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ systemd —Å–ª—É–∂–±—ã:

```bash
# API –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
sudo systemctl enable agent-api.service

# API –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
# (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ agent-api.service: Restart=always, RestartSec=5)
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

```bash
# –õ–æ–≥–∏ API —Å–µ—Ä–≤–µ—Ä–∞
sudo journalctl -u agent-api.service -f

# –õ–æ–≥–∏ nginx
sudo tail -f /var/log/nginx/agent-api-access.log
sudo tail -f /var/log/nginx/agent-api-error.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:

```bash
# –°—Ç–∞—Ç—É—Å API —Å–ª—É–∂–±—ã
sudo systemctl status agent-api.service

# –°—Ç–∞—Ç—É—Å nginx
sudo systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
sudo netstat -tlnp | grep -E '(8000|80|443)'
```

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–æ–π

```bash
# –ó–∞–ø—É—Å–∫
sudo systemctl start agent-api.service

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo systemctl stop agent-api.service

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo systemctl restart agent-api.service

# –°—Ç–∞—Ç—É—Å
sudo systemctl status agent-api.service

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u agent-api.service -n 100
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### –ß–µ—Ä–µ–∑ curl:

```bash
# Health check
curl https://server.asktab.ru/health

# API info
curl https://server.asktab.ru/api/info

# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
curl -X POST https://server.asktab.ru/api/analyze \
  -H "Content-Type: application/json" \
  -d '{
    "query": "–ü–æ–∫–∞–∂–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
  }'
```

### –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `https://server.asktab.ru` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
3. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
4. –ü–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)

### –ß–µ—Ä–µ–∑ JavaScript (–¥–ª—è front-end):

```javascript
async function analyzeData(query) {
  const response = await fetch('https://server.asktab.ru/api/analyze', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      query: query,
      session_id: 'my-session-id'  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    })
  });

  const result = await response.json();

  if (result.success) {
    console.log('–û—Ç–≤–µ—Ç:', result.text_output);
    console.log('–ì—Ä–∞—Ñ–∏–∫–∏:', result.plots);  // base64 PNG
  } else {
    console.error('–û—à–∏–±–∫–∞:', result.error);
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
analyzeData('–ü–æ–∫–∞–∂–∏ —Ç–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ');
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ó–∞—â–∏—Ç–∞ .env —Ñ–∞–π–ª–∞:**
   ```bash
   chmod 600 .env
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall:**
   ```bash
   sudo ufw allow 22    # SSH
   sudo ufw allow 80    # HTTP
   sudo ufw allow 443   # HTTPS
   sudo ufw enable
   ```

3. **SSL/HTTPS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
   ```bash
   sudo certbot --nginx -d server.asktab.ru
   ```

4. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
   ```bash
   sudo apt update && sudo apt upgrade -y
   ```

---

## üìû –û–±—Ä–∞—â–µ–Ω–∏–µ front-end –∫ API

–í–∞—à front-end —Å–∞–π—Ç –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

### –ü—Ä–∏–º–µ—Ä React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:

```jsx
import React, { useState } from 'react';

function DataAnalyzer() {
  const [query, setQuery] = useState('');
  const [result, setResult] = useState(null);
  const [loading, setLoading] = useState(false);

  const analyzeData = async () => {
    setLoading(true);
    try {
      const response = await fetch('https://server.asktab.ru/api/analyze', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ query })
      });

      const data = await response.json();
      setResult(data);
    } catch (error) {
      console.error('Error:', error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div>
      <textarea
        value={query}
        onChange={(e) => setQuery(e.target.value)}
        placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å..."
      />
      <button onClick={analyzeData} disabled={loading}>
        {loading ? '–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é...' : '–û—Ç–ø—Ä–∞–≤–∏—Ç—å'}
      </button>

      {result && result.success && (
        <div>
          <p>{result.text_output}</p>
          {result.plots.map((plot, idx) => (
            <img
              key={idx}
              src={`data:image/png;base64,${plot}`}
              alt="–ì—Ä–∞—Ñ–∏–∫"
            />
          ))}
        </div>
      )}
    </div>
  );
}

export default DataAnalyzer;
```

### CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

API —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª—é–±—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏:
```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –≤–∞—à–µ–º—É front-end –¥–æ–º–µ–Ω—É, –∏–∑–º–µ–Ω–∏—Ç–µ –≤ `api_server.py`:
```python
allow_origins=["https://your-frontend-domain.com"]
```

---

## üéâ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`./setup.sh`)
- [ ] `.env` —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
- [ ] ClickHouse –¥–æ—Å—Ç—É–ø–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `test_agent.py` —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- [ ] systemd —Å–ª—É–∂–±–∞ –∑–∞–ø—É—â–µ–Ω–∞ –∏ –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–µ
- [ ] nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—É—á–µ–Ω –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] `https://server.asktab.ru` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] API –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã
- [ ] Front-end –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **[README.md](README.md)** - –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ
- **[INSTALLATION.md](INSTALLATION.md)** - –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **[DEPLOYMENT.md](DEPLOYMENT.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
- **[QUICKSTART_DEPLOYMENT.md](QUICKSTART_DEPLOYMENT.md)** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
- "–ü–æ–∫–∞–∂–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
- "–í—ã–≥—Ä—É–∑–∏ –ø–µ—Ä–≤—ã–µ 100 –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã sales"

### –ó–∞–ø—Ä–æ—Å—ã —Å –∞–Ω–∞–ª–∏–∑–æ–º:
- "–ü–æ–∫–∞–∂–∏ —Ç–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ"
- "–ü–æ—Å—á–∏—Ç–∞–π –æ–±—â—É—é –≤—ã—Ä—É—á–∫—É –ø–æ –º–µ—Å—è—Ü–∞–º –∑–∞ 2024 –≥–æ–¥"

### –ó–∞–ø—Ä–æ—Å—ã —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π:
- "–ü–æ—Å—Ç—Ä–æ–π bar chart —Ç–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ"
- "–ü–æ—Å—Ç—Ä–æ–π line chart –ø—Ä–æ–¥–∞–∂ –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –¥–æ–±–∞–≤—å —Ç—Ä–µ–Ω–¥"

### –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
- "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö, –ø–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –ø–æ—Å—Ç—Ä–æ–π 3 –≥—Ä–∞—Ñ–∏–∫–∞: –≤—ã—Ä—É—á–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º, —Ç–æ–ø —Ç–æ–≤–∞—Ä–æ–≤, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"

---

## ‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –ø–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π?
```bash
cd /opt/agent_api/agent_clickhouse_python_v1
git pull origin main
source venv/bin/activate
pip install -r requirements.txt --upgrade
sudo systemctl restart agent-api.service
```

### Q: –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏?
```bash
sudo journalctl -u agent-api.service -n 50 --no-pager
```

### Q: API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å?
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status agent-api.service

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl restart agent-api.service

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
sudo journalctl -u agent-api.service -f
```

### Q: –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç API?
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `api_server.py`, —Å—Ç—Ä–æ–∫–∞:
```python
uvicorn.run("api_server:app", host="0.0.0.0", port=8000, ...)
```

–ó–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç–µ `nginx.conf` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ API?
–î–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Gunicorn (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ DEPLOYMENT.md, —Ä–∞–∑–¥–µ–ª "–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ").

---

## üöÄ –ì–æ—Ç–æ–≤–æ!

–í–∞—à ClickHouse Analysis Agent API —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ `https://server.asktab.ru`!

- ‚úÖ API —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å front-end
- ‚úÖ SSL/HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!**
